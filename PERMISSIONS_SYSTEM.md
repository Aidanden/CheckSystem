# نظام الصلاحيات المحدث - Check Printing System

## التاريخ: 2025-12-03

## نظرة عامة

تم تحديث نظام الصلاحيات ليكون أكثر تفصيلاً ودقة. الآن كل شاشة لها صلاحية منفصلة، وبعض الشاشات (مثل سجلات الطباعة) لها صلاحيات متعددة.

---

## الصلاحيات الجديدة

### 1. صلاحيات إدارة النظام

| الكود | الاسم | الوصف |
|:---|:---|:---|
| `MANAGE_USERS` | إدارة المستخدمين | القدرة على إضافة/تعديل/حذف المستخدمين |
| `MANAGE_BRANCHES` | إدارة الفروع | القدرة على إضافة/تعديل الفروع |
| `SYSTEM_SETTINGS` | إعدادات الطباعة | الوصول إلى شاشة إعدادات الطباعة وتخطيط الشيكات |

### 2. صلاحيات الشاشات الرئيسية

| الكود | الاسم | الوصف |
|:---|:---|:---|
| `SCREEN_PRINT` | شاشة الطباعة | الوصول إلى شاشة طباعة الشيكات |
| `SCREEN_PRINT_LOGS` | شاشة سجلات الطباعة | الوصول إلى شاشة سجلات الطباعة |
| `SCREEN_REPORTS` | شاشة التقارير | الوصول إلى شاشة التقارير |

### 3. صلاحيات العمليات الخاصة

| الكود | الاسم | الوصف |
|:---|:---|:---|
| `REPRINT` | إعادة الطباعة | القدرة على إعادة طباعة الشيكات من شاشة سجلات الطباعة |

---

## منطق الصلاحيات

### شاشة سجلات الطباعة (Print Logs)

هذه الشاشة لها **صلاحيتان منفصلتان**:

1. **`SCREEN_PRINT_LOGS`**: للوصول إلى الشاشة وعرض السجلات
2. **`REPRINT`**: لإعادة طباعة الشيكات من الشاشة

**مثال:**
- مستخدم لديه `SCREEN_PRINT_LOGS` فقط → يمكنه عرض السجلات فقط
- مستخدم لديه `SCREEN_PRINT_LOGS` + `REPRINT` → يمكنه عرض السجلات وإعادة الطباعة

---

## الصلاحيات الافتراضية

### المدير (Admin)
✅ **جميع الصلاحيات** - يحصل على كل الصلاحيات تلقائياً

### مستخدمي الفروع (Branch Users)
الصلاحيات الافتراضية:
- ✅ `SCREEN_PRINT` - شاشة الطباعة
- ✅ `SCREEN_PRINT_LOGS` - شاشة سجلات الطباعة
- ✅ `SCREEN_REPORTS` - شاشة التقارير
- ❌ `REPRINT` - **لا يمتلكون** صلاحية إعادة الطباعة افتراضياً

---

## ملاحظات مهمة

1. **تم إخفاء صلاحيات المخزون**: تم إزالة `SCREEN_INVENTORY` و `MANAGE_INVENTORY` من النظام حالياً.
2. **إعدادات النظام**: تم تغيير اسمها إلى "إعدادات الطباعة" لتوضيح وظيفتها.

---

## كيفية تطبيق التحديثات

### 1. تحديث قاعدة البيانات

```bash
# في مجلد server
npx prisma db seed
```

هذا سيقوم بـ:
- حذف الصلاحيات القديمة
- إنشاء الصلاحيات الجديدة
- تعيين الصلاحيات للمستخدمين الموجودين
